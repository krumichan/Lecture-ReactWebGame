<html>
<head>
    <!-- release 할 때에는 아래로 바꿔줄 필요가 있음.
            <script crossorigin src="https://unpkg.com/react@16/umd/react.produnction.js"></script>
    -->
    <meta charset="UTF-8"/>
    <title>Times Table</title>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>

    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
    class TimesTable extends React.Component {
        state = {
            first: Math.ceil(Math.random() * 9)
            , second: Math.ceil(Math.random() * 9)
            , value: ''
            , result: ''
            ,
        };

        input;

        onSubmit = (e) => {
            e.preventDefault();
            if (parseInt(this.state.value) === this.state.first * this.state.second) {
                // setState() 함수는 비동기 함수이다. ( 주의 )
                this.setState((prevState) => {
                    const prevResult = 'prev [' +
                        prevState.first + " * " + prevState.second + " = " + prevState.value
                        + ']';
                    return {
                        result: prevResult + '정답'
                        , first: Math.ceil(Math.random() * 9)
                        , second: Math.ceil(Math.random() * 9)
                        , value: ''
                        ,
                    }
                })
            } else {
                this.setState({
                    result: '땡'
                    , value: ''
                    ,
                })
            }
            this.input.focus();
        };

        onChange = (e) => {
            this.setState({
                value: e.target.value
                ,
            });
        };

        ref = (c) => {
            this.input = c;
        };

        /**
         * render() 함수의 경우,
         * setState() 함수가 호출될 때마다 같이 호출되기 때문에,
         * 내부에서 Lambda 를 사용하는 것은 좋지 않다.
         * ( 호출될 때마다 익명 함수가 생성되어버리기 때문이다. )
         * 때문에, render() 함수 내부에서 다른 함수 등의 식을 호출할 필요가 있는 경우,
         * 함수화하여 사용하는 것이 좋다.
         */
        render() {
            return (
                // <div>
                // div 를 안쓰기 위함.
                <React.Fragment>
                    <div>{this.state.first} * {this.state.second} 는?</div>
                    <form onSubmit={this.onSubmit}>
                        <input ref={this.ref} type="number" value={this.state.value} onChange={this.onChange}/>
                        <button>입력!</button>
                    </form>
                    <div>{this.state.result}</div>
                </React.Fragment>
                // </div>
            );
        }
    }
</script>
<script type="text/babel">
    ReactDOM.render(
        <div>
            <TimesTable/>
        </div>
        , document.querySelector('#root'));
</script>
</body>
</html>