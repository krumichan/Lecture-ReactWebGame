<html>
<head>
    <!-- release 할 때에는 아래로 바꿔줄 필요가 있음.
            <script crossorigin src="https://unpkg.com/react@16/umd/react.produnction.js"></script>
    -->
    <meta charset="UTF-8"/>
    <title>[Hooks] Times Table</title>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>

    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
    // class TimesTable extends React.Component {
    // }

    /**
     * 함수 Component로, Hooks는 아니다.
     * setState() 또는 ref 속성을 사용하지 않을 경우,
     * 아래와 같은 함수형으로 만든다.
     */
    const TimesTableFunctional = () => {
        return <div>Hello, Functional. <hr/></div>
    }

    /**
     * React Hooks는
     * 함수형에서 쓸 수 없던
     * setState()와 ref 속성 등을 사용할 수 있게 한 것이다.
     *
     * 단점은,
     * Hooks의 경우,
     * re-rendering 이 될 때,
     * 아래의 함수가 다시 호출되기 때문에,
     * 함수 내부가 전부 통체로 제 실행된다.
     * ( class 의 경우는, render() 함수만 재호출 되었었다. )
     */
    const TimesTableHooks = () => {
        // 형식 :  const [ <valueName>, <valueName 전용 setState> ] = React.useState( <초기값> );
        // 변수 부분에 [] 등을 쓰는 것을 "구조 분해 할당" 이라고 한다. ( Destructuring )
        const [first, setFirst] = React.useState(Math.ceil(Math.random() * 9));
        const [second, setSecond] = React.useState(Math.ceil(Math.random() * 9));
        const [value, setValue] = React.useState('');
        const [result, setResult] = React.useState('');
        const inputRef = React.useRef(null);

        const onChange = (e) => {
            setValue(e.target.value);
        }

        const onSubmit = (e) => {
            e.preventDefault();
            if (parseInt(value) === first * second) {
                setResult('정답: ' + value);
                setFirst(Math.ceil(Math.random() * 9));
                setSecond(Math.ceil(Math.random() * 9));
                setValue('');
            } else {
                setResult('땡');
                setValue('');
            }
            inputRef.current.focus();
        }

        return (
            <React.Fragment>
                <div>Hello, Hooks.<p/></div>
                <div>{first} * {second} 는?</div>
                <form onSubmit={onSubmit}>
                    <input ref={inputRef} type="number" onChange={onChange} value={value}/>
                    <button>입력!</button>
                    <div id="result">{result}</div>
                </form>
            </React.Fragment>
        );
    }
</script>
<script type="text/babel">
    ReactDOM.render(
        <div>
            <TimesTableFunctional/>
            <TimesTableHooks/>
        </div>
        , document.querySelector('#root'));
</script>
</body>
</html>